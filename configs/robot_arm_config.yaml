# PCB 불량 검사 시스템 - 로봇팔 설정
# Arduino Mega 2560 + 5-6축 로봇팔

# ========================================
# 시리얼 통신 설정
# ========================================
serial:
  port: /dev/ttyACM0           # Arduino 포트 (라즈베리파이)
  baudrate: 115200             # 통신 속도
  timeout: 5                   # 읽기 타임아웃 (초)
  write_timeout: 2             # 쓰기 타임아웃 (초)

# ========================================
# 서보 모터 설정 (6축)
# ========================================
servos:
  # 각 서보의 핀 번호 및 범위
  base:                        # 베이스 회전 (0-180도)
    pin: 2
    min_angle: 0
    max_angle: 180
    home_angle: 90

  shoulder:                    # 어깨 (0-180도)
    pin: 3
    min_angle: 0
    max_angle: 180
    home_angle: 90

  elbow:                       # 팔꿈치 (0-180도)
    pin: 4
    min_angle: 0
    max_angle: 180
    home_angle: 90

  wrist_pitch:                 # 손목 피치 (0-180도)
    pin: 5
    min_angle: 0
    max_angle: 180
    home_angle: 90

  wrist_roll:                  # 손목 롤 (0-180도)
    pin: 6
    min_angle: 0
    max_angle: 180
    home_angle: 90

  gripper:                     # 그리퍼 (0-90도)
    pin: 7
    min_angle: 0               # 완전히 열림
    max_angle: 90              # 완전히 닫힘
    home_angle: 0              # 기본: 열림

# ========================================
# 동작 설정
# ========================================
motion:
  speed: 50                    # 서보 속도 (0-100, 낮을수록 느림)
  acceleration: 30             # 가속도 (0-100)
  gripper_close_angle: 75      # PCB 잡을 때 그리퍼 각도
  gripper_open_angle: 0        # PCB 놓을 때 그리퍼 각도
  pickup_height_offset: 10     # 픽업 시 Z축 오프셋 (mm)
  place_height_offset: 5       # 배치 시 Z축 오프셋 (mm)

# ========================================
# 픽업 위치 (컨베이어 벨트)
# ========================================
pickup_position:
  x: 150.0                     # X 좌표 (mm)
  y: 0.0                       # Y 좌표 (mm)
  z: 50.0                      # Z 좌표 (mm)
  description: "컨베이어 벨트 중앙 위치"

# ========================================
# 박스 슬롯 좌표 (15개 슬롯 + 폐기 위치)
# 3개 카테고리 × 5개 슬롯 (수평 배치) = 15개 슬롯
# 폐기는 별도 위치 (슬롯 관리 안 함)
# ========================================

box_coordinates:
  # 정상 박스 (NORMAL) - 5개 슬롯 (수평 배열)
  NORMAL:
    slot_0: {x: 190.0, y: 100.0, z: 30.0}
    slot_1: {x: 210.0, y: 100.0, z: 30.0}
    slot_2: {x: 230.0, y: 100.0, z: 30.0}
    slot_3: {x: 250.0, y: 100.0, z: 30.0}
    slot_4: {x: 270.0, y: 100.0, z: 30.0}

  # 부품 불량 박스 (COMPONENT_DEFECT) - 5개 슬롯 (수평 배열)
  COMPONENT_DEFECT:
    slot_0: {x: 190.0, y: 140.0, z: 30.0}
    slot_1: {x: 210.0, y: 140.0, z: 30.0}
    slot_2: {x: 230.0, y: 140.0, z: 30.0}
    slot_3: {x: 250.0, y: 140.0, z: 30.0}
    slot_4: {x: 270.0, y: 140.0, z: 30.0}

  # 납땜 불량 박스 (SOLDER_DEFECT) - 5개 슬롯 (수평 배열)
  SOLDER_DEFECT:
    slot_0: {x: 190.0, y: 180.0, z: 30.0}
    slot_1: {x: 210.0, y: 180.0, z: 30.0}
    slot_2: {x: 230.0, y: 180.0, z: 30.0}
    slot_3: {x: 250.0, y: 180.0, z: 30.0}
    slot_4: {x: 270.0, y: 180.0, z: 30.0}

# ========================================
# 폐기 위치 (슬롯 관리 안 함)
# 로봇팔이 이동해서 PCB를 박스에 떨어뜨림
# ========================================
discard_position:
  x: 200.0
  y: 220.0
  z: 60.0    # 높이에서 떨어뜨리기
  description: "폐기 박스 위치 (슬롯 관리 없음)"

# ========================================
# 안전 설정
# ========================================
safety:
  enable_limits: true          # 리미트 스위치 사용
  collision_detection: true    # 충돌 감지 사용
  max_force: 50                # 최대 힘 (0-100)
  emergency_stop_pin: 8        # 비상 정지 버튼 핀

  # 작업 공간 제한 (mm)
  workspace_limits:
    x_min: 0
    x_max: 350
    y_min: -50
    y_max: 300
    z_min: 0
    z_max: 150

# ========================================
# 캘리브레이션 설정
# ========================================
calibration:
  # 각 박스의 Z축 높이 오프셋 (실제 측정값으로 조정)
  box_height_offsets:
    NORMAL: 0.0
    COMPONENT_DEFECT: 0.0
    SOLDER_DEFECT: 0.0
    DISCARD: 0.0

  # PCB 크기 (mm)
  pcb_dimensions:
    width: 60
    height: 40
    thickness: 1.6

# ========================================
# 로깅 설정
# ========================================
logging:
  enable: true
  log_level: INFO              # DEBUG, INFO, WARNING, ERROR
  log_file: /var/log/robot_arm.log
  log_rotation: daily          # daily, weekly, monthly
  max_log_size_mb: 100

# ========================================
# 주석
# ========================================
#
# 좌표 시스템:
#   - X축: 좌->우 (로봇팔 기준)
#   - Y축: 앞->뒤
#   - Z축: 아래->위
#
# 좌표 단위: mm (밀리미터)
#
# 박스 배치 (3개 박스):
#   - 정상 (NORMAL): Y = 100mm
#   - 부품불량 (COMPONENT_DEFECT): Y = 140mm
#   - 납땜불량 (SOLDER_DEFECT): Y = 180mm
#   - 폐기 (DISCARD): Y = 220mm (슬롯 관리 안 함)
#
# 슬롯 구조:
#   - 각 박스당 5개 슬롯 (수평 배열, x축 방향 20mm 간격)
#   - slot_0: 가장 좌측, slot_4: 가장 우측 (z = 30mm 공통)
#   - 총 15개 슬롯 (3개 박스 × 5개 슬롯)
#
# 주의사항:
#   - 좌표 값은 실제 로봇팔과 박스 위치에 맞게 캘리브레이션 필요
#   - 초기 테스트 시 낮은 속도로 시작 (speed: 30)
#   - 충돌 방지를 위해 안전 설정 확인
#   - 폐기는 슬롯 관리 없이 박스에 떨어뜨리기만 함
#
